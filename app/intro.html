<!DOCTYPE html>
<html>
	//= components/base/head.html
<body>

<section scrollbar class="getHeight" id="my-scrollbar">
	//= components/ux/parallax.html


	<!-- Application -->
	<div class="app landing" style="background: transparent;">
		//= components/base/menu-top.html
		
		
		<div class="wr js-mt" style="height: 3000px; position: relative; background: #fff; margin-top: 800px;"></div>

		//= components/base/footer.html
	</div>

	<!-- Scripts -->
	//= components/base/scripts.html
</section>

	<script>
$(document).ready(function() {


	var Scrollbar = $(window).Scrollbar;
	// var scrollbar = Scrollbar.init(document.body, { speed: 0.75 });

	Scrollbar.initAll();

	var scrollbar = Scrollbar.init(document.getElementById('my-scrollbar'), { 
		speed: 1,
		damping: 0.01,
		renderByPixels: true,
		alwaysShowTracks: false,
		continuousScrolling: 'auto',
		overscrollEffect: 'glow',
		overscrollEffectColor: '#3f86ff',
		update: true
	})

	// var scrollbar = Scrollbar.init(document.body, {
		// speed: 1,
		// damping: 0.01,
		// renderByPixels: true,
		// alwaysShowTracks: false,
		// continuousScrolling: 'auto',
		// overscrollEffect: 'glow',
		// overscrollEffectColor: '#3f86ff',
		// update: true
	// });


	addHeight();


		// get HEIGHT data
	var windowHeight = $(window).innerHeight(),
		pageHeight = $('body').height(),

		// menu-top
		header = $(".js-header"),
		scrollPrev = 0,

		// slider-parallax
		lastScrollTop = 0,
		isBulletsVisible = false;


	

	// slider-parallax bulets
	$('.slide-indicator a').click(function() {
		if ($(this).hasClass('active')) {
			return false;
		}
		var i = $('.slide-indicator a').index($(this));
		$('html').velocity('scroll', {offset: $('.slide-wrapper').eq(i).offset().top + 1, duration: 1000, easing: 'easeOutExpo', mobileHA: false});
		return false;
	});

	scrollbar.addListener(function (status) {

		addHeight();

		var windowHeight = $(window).innerHeight(),
			pageOffset = $(window).scrollTop(),
			pageHeight = $('body').height();

		// swith SLIDER and FOOTER
		if (pageOffset >= pageHeight/3) {
			$('.footer').css('z-index','2');
			$('.slides').css('z-index','1');
		} else {
			$('.slides').css('z-index','2');
			$('.footer').css('z-index','1');
		}

		var scrolled = $(window).scrollTop(),
			firstScrollUp = false,
			firstScrollDown = false;

		if ( scrolled > 0 ) {
			if ( scrolled > scrollPrev ) {
				firstScrollUp = false;
				if ( scrolled < header.height() + header.offset().top ) {
					if ( firstScrollDown === false ) {
						header.removeClass('active');
						firstScrollDown = true;
					}
				} else {
					header.removeClass('active');
				}
			} else {
				firstScrollDown = false;
				if ( scrolled > header.offset().top ) {
					if ( firstScrollUp === false ) {
						header.addClass('active');
						firstScrollUp = true;
					};
				}
			}
			scrollPrev = scrolled;
		}

		// 
		var totalSlides = $('.slide-wrapper').length;
		if (totalSlides > 0) {
			var lastOffset = $('.slide-wrapper:last').offset().top;
			
			$('.slide-wrapper').each(function(i) {
				var isLast = (i == (totalSlides - 1));
				
				if (scrolled > $(this).offset().top && scrolled < lastOffset) {
					if (!isLast) {
						$(this).find('.slide1').css({'position': 'fixed', 'top': 0, 'left': 0});
					}
				} else {
					$(this).find('.slide1').css('position', 'relative');
				}
				
				if (scrolled > $(this).offset().top && scrolled < lastOffset + 200) {
					setActiveBullet(i);
				}
			});

			// if (scrolled > $('.slide-wrapper:last').offset().top) {
			// 	$('html').css('overflow', 'hidden');
			// 	$('.getHeight').css('top', -windowHeight);
			// }

			// if (scrolled < $('.getHeight').offset().top) {
			// 	$('html').css('overflow', 'visible');
			// 	$('.getHeight').css('top', '0');
			// }
			
			if (scrolled > $('.slide-wrapper:first').offset().top && scrolled < lastOffset + 200) {
				if (!isBulletsVisible) {
					showBullets();
				}
			} else if (isBulletsVisible) {
				removeBullets();
				
			}
		}
	});
});

$(window).load(function() {
	// scrolling to top
	// var windowOffset = $(window).scrollTop();
	// if(windowOffset != 0) {
	// 	setTimeout(function(){
	// 		window.scrollTo(0,0);
	// 	}, 10);
	// }


	// setTimeout(function(){
	// 	// preloader
	// 	$('.preloader').fadeOut();

	// 	// intro img animation
	// 	$('.intro-img').removeClass('inactive');
	// }, 500);
});

$(window).resize(function() {
	addHeight();
}).resize();

function addHeight() {
	var windowHeight = $(window).innerHeight();

	// add window HEIGHT to DIVs
	$('.slide-wrapper').css('height', windowHeight);
	$('.rasporka').css('height', windowHeight);
	$('.getHeight').css('height', windowHeight);

	// add margin
	$('.js-mt').css('margin-top', windowHeight);
}






	// bullets for example-section
function setActiveBullet(i) {
	$('.slide-indicator a').removeClass('active');
	$('.slide-indicator a').eq(i).addClass('active');
}
function showBullets() {
	isBulletsVisible = true;
	var si = $('.slide-indicator');
	si.show();
	si.addClass('animated').addClass(si.data('in'));
	si.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {
		si.removeClass('animated').removeClass(si.data('out')).removeClass(si.data('in'));
	});
}
function removeBullets() {
	isBulletsVisible = false;
	var si = $('.slide-indicator');
	si.addClass('animated').addClass(si.data('out'));
	si.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {
		si.removeClass('animated').removeClass(si.data('out')).removeClass(si.data('in'));
		si.hide();
	});
}
	</script>
</body>
</html>